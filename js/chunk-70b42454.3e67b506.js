(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70b42454"],{"0621":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"more-setting"},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-position":"top","label-width":"80px"}},[a("h5",{staticClass:"setting-title"},[t._v("发布设置")]),a("div",{staticClass:"image-setting"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{name:"image",action:"/api/v1/upload/single","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.formData.imageUrl?[a("i",{staticClass:"el-icon-delete-solid",on:{click:function(e){return e.stopPropagation(),t.removeImage(e)}}}),a("img",{staticClass:"avatar",attrs:{src:t.formData.imageUrl}})]:[a("el-button",[t._v("Upload post image")]),a("i",{staticClass:"el-icon-camera-solid"})]],2)],1),a("el-form-item",{attrs:{label:"Post URL"}},[a("el-input",{model:{value:t.formData.slug,callback:function(e){t.$set(t.formData,"slug",e)},expression:"formData.slug"}})],1),"post"===t.type?a("el-form-item",{attrs:{label:"Publish Date"}},[a("el-date-picker",{attrs:{align:"right",type:"datetime",placeholder:"选择日期时间"},model:{value:t.formData.publish_date,callback:function(e){t.$set(t.formData,"publish_date",e)},expression:"formData.publish_date"}})],1):t._e(),"post"===t.type?a("el-form-item",{attrs:{label:"Tags"}},[a("el-select",{attrs:{multiple:!0,loading:t.tagLoading,filterable:!0},model:{value:t.formData.tagIds,callback:function(e){t.$set(t.formData,"tagIds",e)},expression:"formData.tagIds"}},t._l(t.tagsList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1):t._e(),a("el-form-item",{attrs:{label:"Meta"}},[a("el-input",{attrs:{rows:3,type:"text"},model:{value:t.formData.meta_title,callback:function(e){t.$set(t.formData,"meta_title",e)},expression:"formData.meta_title"}})],1),a("el-form-item",{attrs:{label:"Meta Description"}},[a("el-input",{attrs:{rows:3,type:"textarea"},model:{value:t.formData.meta_description,callback:function(e){t.$set(t.formData,"meta_description",e)},expression:"formData.meta_description"}})],1),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),a("el-button",{on:{click:t.closeModal}},[t._v("取消")])],1)],1)],1)},i=[],r=(a("96cf"),a("3b8d")),o=(a("7514"),a("d225")),s=a("b0b4"),c=a("308d"),l=a("6bb5"),u=a("4e2b"),f=a("9ab4"),p=a("60a3"),d=a("08ba"),m=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.formData={slug:"",tagIds:[],meta_title:"",meta_description:"",publish_date:"",imageUrl:""},t.tagLoading=!1,t.tagsList=[],t}return Object(u["a"])(e,t),Object(s["a"])(e,[{key:"mounted",value:function(){this.loadTags(),this.setting&&(console.log(this.setting),Object.assign(this.formData,this.setting),this.formData.tagIds=this.setting.tags.map(function(t){return t.id}))}},{key:"onSubmit",value:function(){var t=this,e=Object.assign({},this.formData);e.tags=this.formData.tagIds.map(function(e){return t.tagsList.find(function(t){return t.id===e})}),console.log(e),this.$emit("change",e),this.$emit("close")}},{key:"loadTags",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.tagLoading=!0,t.next=4,d["a"].tagService.findAll({pageSize:1e3});case 4:e=t.sent,this.tagsList=e.items||[];case 6:return t.prev=6,this.tagLoading=!1,t.finish(6);case 9:case"end":return t.stop()}},t,this,[[0,,6,9]])}));function e(){return t.apply(this,arguments)}return e}()},{key:"handleAvatarSuccess",value:function(t){console.log(t),console.log("handleAvatarSuccess..."),this.formData.imageUrl=t.data.originalname}},{key:"beforeAvatarUpload",value:function(t){}},{key:"beforeRemove",value:function(){console.log("beforeRemove...")}},{key:"removeImage",value:function(){console.log("removeImage..."),this.formData.imageUrl=""}},{key:"closeModal",value:function(t){t.target&&"更多设置"===t.target.textContent?console.log("click 更多设置"):this.$emit("close")}}]),e}(p["c"]);f["a"]([Object(p["b"])()],m.prototype,"setting",void 0),f["a"]([Object(p["b"])({default:"post"})],m.prototype,"type",void 0),m=f["a"]([p["a"]],m);var g=m,v=g,b=(a("7455"),a("2877")),h=Object(b["a"])(v,n,i,!1,null,"37b523f6",null);e["a"]=h.exports},"08ba":function(t,e,a){"use strict";var n=a("3402"),i=a("0e9d"),r={findAll:function(t){return i["a"].get("/tags",{query:t})},create:function(t){return i["a"].post("/tags",{payload:t})},delete:function(t){return i["a"].delete("/tags/"+t,{})},update:function(t){return i["a"].put("/tags/"+t.id,{payload:t})},search:function(t){var e={keyword:t};return i["a"].get("/tags/search",{query:e})}},o=a("a6bd"),s=a("3550"),c=a("06a0"),l={upload:function(t){return i["a"].post("/upload/single",{payload:t,headers:{"Content-Type":"multipart/form-data"}})}},u=a("cbc5");e["a"]={postService:n["a"],tagService:r,navigationService:o["a"],settingService:s["a"],userService:c["a"],fileService:l,categoryService:u["a"]}},"0a49":function(t,e,a){var n=a("9b43"),i=a("626a"),r=a("4bf8"),o=a("9def"),s=a("cd1c");t.exports=function(t,e){var a=1==t,c=2==t,l=3==t,u=4==t,f=6==t,p=5==t||f,d=e||s;return function(e,s,m){for(var g,v,b=r(e),h=i(b),y=n(s,m,3),k=o(h.length),w=0,D=a?d(e,k):c?d(e,0):void 0;k>w;w++)if((p||w in h)&&(g=h[w],v=y(g,w,b),t))if(a)D[w]=v;else if(v)switch(t){case 3:return!0;case 5:return g;case 6:return w;case 2:D.push(g)}else if(u)return!1;return f?-1:l||u?u:D}}},1169:function(t,e,a){var n=a("2d95");t.exports=Array.isArray||function(t){return"Array"==n(t)}},3402:function(t,e,a){"use strict";var n=a("0e9d");e["a"]={findAll:function(t){return n["a"].get("/posts",{query:t})},get:function(t){return n["a"].get("/posts/"+t,{})},create:function(t){return n["a"].post("/posts",{payload:t})},delete:function(t){return n["a"].delete("/posts/"+t,{})},update:function(t){return n["a"].put("/posts/"+t.id,{payload:t})}}},3550:function(t,e,a){"use strict";var n=a("0e9d");e["a"]={findBaseSetting:function(){return n["a"].get("/setting/base",{})},updateBaseSetting:function(t){return n["a"].post("/setting/base",{payload:t})},findEmailSetting:function(){return n["a"].get("/setting/email",{})},updateEmailSetting:function(t){return n["a"].post("/setting/email",{payload:t})}}},"71a5":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("main-panel",{staticClass:"post-container",attrs:{title:"创建文章"}},[a("post-add-form")],1)},i=[],r=a("d225"),o=a("308d"),s=a("6bb5"),c=a("4e2b"),l=a("9ab4"),u=a("60a3"),f=a("a758"),p=function(t){function e(){return Object(r["a"])(this,e),Object(o["a"])(this,Object(s["a"])(e).apply(this,arguments))}return Object(c["a"])(e,t),e}(u["c"]);p=l["a"]([Object(u["a"])({components:{PostAddForm:f["a"]}})],p);var d=p,m=d,g=a("2877"),v=Object(g["a"])(m,n,i,!1,null,null,null);e["default"]=v.exports},7455:function(t,e,a){"use strict";var n=a("a5bf"),i=a.n(n);i.a},7514:function(t,e,a){"use strict";var n=a("5ca1"),i=a("0a49")(5),r="find",o=!0;r in[]&&Array(1)[r](function(){o=!1}),n(n.P+n.F*o,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(r)},a5bf:function(t,e,a){},a6bd:function(t,e,a){"use strict";var n=a("0e9d");e["a"]={findAll:function(t){return n["a"].get("/navigations",{query:t})},create:function(t){return n["a"].post("/navigations",{payload:t})},delete:function(t){return n["a"].delete("/navigations/"+t,{})},update:function(t){return n["a"].put("/navigations/"+t.id,{payload:t})},moveLeft:function(t){return n["a"].post("/navigations/prev",{payload:t})},moveRight:function(t){return n["a"].post("/navigations/next",{payload:t})}}},a758:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"form-container"},[a("el-form",{ref:"form",staticClass:"add-form",attrs:{model:t.formData,"label-width":"80px",size:"mini"}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{staticStyle:{width:"420px"},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("el-form-item",{attrs:{label:"内容"}},[a("mavon-editor",{ref:"md",staticClass:"markdown-box",on:{imgAdd:t.imgAdd},model:{value:t.formData.markdown,callback:function(e){t.$set(t.formData,"markdown",e)},expression:"formData.markdown"}})],1),a("el-form-item",{attrs:{label:"摘要"}},[a("el-input",{staticStyle:{width:"420px"},attrs:{rows:5,type:"textarea"},model:{value:t.formData.excerpt,callback:function(e){t.$set(t.formData,"excerpt",e)},expression:"formData.excerpt"}}),a("span",[t._v("    ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showMoreSet(!0)}}},[t._v("更多设置")])],1),a("el-form-item",["page"===t.type?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.publish(!0)}}},[t._v("确定")]):t._e(),"post"===t.type?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.publish(!1)}}},[t._v("保存")]):t._e(),"post"===t.type?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.publish(!0)}}},[t._v("发布")]):t._e(),a("el-button",{on:{click:function(e){return t.showMoreSet(!1)}}},[t._v("取消")])],1)],1),a("transition",{attrs:{name:"slide-fade"}},[a("more-setting",{directives:[{name:"show",rawName:"v-show",value:t.showSetting,expression:"showSetting"}],staticClass:"fix-setting",attrs:{type:t.type},on:{close:function(e){return t.showMoreSet(!1)},change:t.changeSetting}})],1)],1)},i=[],r=(a("96cf"),a("3b8d")),o=a("d225"),s=a("b0b4"),c=a("308d"),l=a("6bb5"),u=a("4e2b"),f=a("9ab4"),p=a("60a3"),d=a("0621"),m=a("08ba"),g=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(c["a"])(this,Object(l["a"])(e).apply(this,arguments)),t.formData={title:"",markdown:"",excerpt:""},t.setting={},t.showSetting=!1,t}return Object(u["a"])(e,t),Object(s["a"])(e,[{key:"publish",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=this.$loading({text:"loading..."}),t.prev=1,console.log("onSubmit..."),n={title:this.formData.title,markdown:this.formData.markdown,excerpt:this.formData.excerpt,slug:this.setting.slug,meta_title:this.setting.meta_title,meta_description:this.setting.meta_description,publish_date:this.setting.publish_date,imageUrl:this.setting.imageUrl,status:e?"published":"draft",postType:this.type},n.tagIds=this.setting.tags.map(function(t){return t.id}),t.next=7,m["a"].postService.create(n);case 7:this.$message.success("添加成功！"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),this.$message.error(t.t0.message);case 13:return t.prev=13,a.close(),t.finish(13);case 16:case"end":return t.stop()}},t,this,[[1,10,13,16]])}));function e(e){return t.apply(this,arguments)}return e}()},{key:"showMoreSet",value:function(t){this.showSetting=!!t}},{key:"changeSetting",value:function(t){Object.assign(this.setting,t)}},{key:"imgAdd",value:function(t,e){console.log(t);var a=this.$refs.md;m["a"].fileService.upload({image:e}).then(function(e){a.$img2Url(t,e.originalname)})}}]),e}(p["c"]);f["a"]([Object(p["b"])({default:"post"})],g.prototype,"type",void 0),g=f["a"]([Object(p["a"])({components:{MoreSetting:d["a"]}})],g);var v=g,b=v,h=(a("c538"),a("2877")),y=Object(h["a"])(b,n,i,!1,null,null,null);e["a"]=y.exports},c538:function(t,e,a){"use strict";var n=a("fa8d"),i=a.n(n);i.a},cbc5:function(t,e,a){"use strict";var n=a("0e9d");e["a"]={findAll:function(t){return n["a"].get("/categorys",{query:t})},create:function(t){return n["a"].post("/categorys",{payload:t})},delete:function(t){return n["a"].delete("/categorys/"+t,{})},update:function(t){return n["a"].put("/categorys/"+t.id,{payload:t})}}},cd1c:function(t,e,a){var n=a("e853");t.exports=function(t,e){return new(n(t))(e)}},e853:function(t,e,a){var n=a("d3f4"),i=a("1169"),r=a("2b4c")("species");t.exports=function(t){var e;return i(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!i(e.prototype)||(e=void 0),n(e)&&(e=e[r],null===e&&(e=void 0))),void 0===e?Array:e}},fa8d:function(t,e,a){}}]);
//# sourceMappingURL=chunk-70b42454.3e67b506.js.map